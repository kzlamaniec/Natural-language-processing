x1,
y1,
paste(
"d",
1:doc_count,
sep = ""
),
col = cols_pattern,
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "mediumvioletred"
)
text(
x2,
y2,
rownames(coord_terms[current_terms,]),
col = "mediumvioletred",
pos = 2
)
legend(
"topright",
inset = c(-0.9, 0.1),
legend,
text.col = cols_pattern
)
dev.off()
# waga tf_410 jako miara ważności słów w dokumentach
for (doc_no in 1:length(corpus)) {
print(rownames(tdm_tfidf_410_m)[doc_no])
print(head(sort(tdm_tfidf_410_m[doc_no,], decreasing = T)))
}
### Dekompozycja według wartości osobliwych ###
#experiment matrix
#exp_matrix <- tdm_tf_all
#exp_matrix <- tdm_tf_612
exp_matrix <- tdm_tfidf_410
# analiza ukrytych wymiarów semantycznych
lsa_model <- lsa(exp_matrix)
coord_docs <- lsa_model$dk%*%diag(lsa_model$sk)
coord_terms <- lsa_model$tk%*%diag(lsa_model$sk)
terms_importance <- diag(
lsa_model$tk%*%diag(lsa_model$sk)%*%t(diag(lsa_model$sk))%*%t(lsa_model$tk)
)
important_terms <- names(
tail(
sort(terms_importance),
30
)
)
#own_terms <- c("daenerys", "jon", "cersei", "eragon", "bilbo", "yennefer", "ciri", "jaskier", "geralt", "frodo", "gandalf", "halt", "ork", "horace")
#own_terms <- c("elf", "czarodziej", "smok", "brat", "arya", "cel", "dawny")
own_terms <- c("catelyn", "brama", "bohater", "bagginsa", "bronić","bezpieczny", "atakować")
current_terms <- own_terms
x1 <- coord_docs[,1]
y1 <- coord_docs[,2]
x2 <- coord_terms[current_terms,1]
y2 <- coord_terms[current_terms,2]
plot_file <- paste(
reduction_dir,
"lsa.png",
sep = "/"
)
png(plot_file, width = 800)
par(mar = c(4, 4, 4, 25), xpd = TRUE)
plot(
x1,
y1,
main = "Analiza ukrytych wymiarów semantycznych",
xlab = "SD1",
ylab = "SD2",
col = cols_pattern,
pch = 16
)
text(
x1,
y1,
paste(
"d",
1:doc_count,
sep = ""
),
col = cols_pattern,
pos = 1
)
points(
x2,
y2,
pch = 15,
col = "mediumvioletred"
)
text(
x2,
y2,
rownames(coord_terms[current_terms,]),
col = "mediumvioletred",
pos = 2
)
legend(
"topright",
inset = c(-0.9, 0.1),
legend,
text.col = cols_pattern
)
dev.off()
### Analiza skupień ###
# utworzenie katalogu na wyniki
clusters_dir <- "./clusters"
dir.create(clusters_dir)
# analiza skupień
clusters_pattern <- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)
cols_pattern <- cols[clusters_pattern]
frequency_matrix <- dtm_tfidf_bounds_m
clusters_pattern <- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)
cols_pattern <- cols[clusters_pattern]
frequency_matrix <- dtm_tfidf_all_m
measure <- "cosine"
method <- "ward.D2"
name <- "tfidf_bounds"
doc_names <- rownames(frequency_matrix)
doc_count <- length(doc_names)
names(clusters_pattern) <- doc_names
names(cols_pattern) <- doc_names
dist_matrix <- dist(frequency_matrix, method = measure)
hierarch_clust <- hclust(dist_matrix, method = method)
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_base.png", sep = ""),
sep = "/"
)
png(plot_file)
plot(hierarch_clust)
dev.off()
dend <- as.dendrogram(hierarch_clust)
clusters_count <- find_k(dend)$k
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_color.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
k = clusters_count,
col = cols
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_pattern.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
col = cols_pattern[dend %>% labels]
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
clusters <- cutree(hierarch_clust, k = clusters_count)
clusters_matrix = matrix(0, doc_count, clusters_count)
rownames(clusters_matrix) <- doc_names
for (doc in 1:doc_count) {
clusters_matrix[doc, clusters[doc]] <- 1
}
plot_file <- paste(
clusters_dir,
paste("matrix_",name,".png", sep = ""),
sep = "/"
)
png(plot_file)
# par(mai = c(1,1,1,4))
corrplot(clusters_matrix)
dev.off()
rand_pattern_experiment <- comPart(clusters, clusters_pattern)
rand_experiment1_experiment2 <- comPart(clusters_1, clusters_2)
clusters_pattern <- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)
cols_pattern <- cols[clusters_pattern]
frequency_matrix <- dtm_tfidf_all_m
measure <- "cosine"
method <- "ward.D2"
name <- "tfidf_bounds"
doc_names <- rownames(frequency_matrix)
doc_count <- length(doc_names)
names(clusters_pattern) <- doc_names
names(cols_pattern) <- doc_names
dist_matrix <- dist(frequency_matrix, method = measure)
hierarch_clust <- hclust(dist_matrix, method = method)
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_base.png", sep = ""),
sep = "/"
)
png(plot_file)
plot(hierarch_clust)
dev.off()
dend <- as.dendrogram(hierarch_clust)
clusters_count <- find_k(dend)$k
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_color.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
k = clusters_count,
col = cols
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_pattern.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
col = cols_pattern[dend %>% labels]
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
clusters <- cutree(hierarch_clust, k = clusters_count)
clusters_matrix = matrix(0, doc_count, clusters_count)
rownames(clusters_matrix) <- doc_names
for (doc in 1:doc_count) {
clusters_matrix[doc, clusters[doc]] <- 1
}
plot_file <- paste(
clusters_dir,
paste("matrix_",name,".png", sep = ""),
sep = "/"
)
png(plot_file)
# par(mai = c(1,1,1,4))
corrplot(clusters_matrix)
dev.off()
rand_pattern_experiment <- comPart(clusters, clusters_pattern)
rand_experiment1_experiment2 <- comPart(clusters_1, clusters_2)
# utworzenie katalogu na wyniki
clusters_dir <- "./clusters"
dir.create(clusters_dir)
# analiza skupień
clusters_pattern <- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)
cols_pattern <- cols[clusters_pattern]
frequency_matrix <- dtm_tfidf_all_m
measure <- "cosine"
method <- "ward.D2"
name <- "tfidf_bounds"
doc_names <- rownames(frequency_matrix)
doc_count <- length(doc_names)
names(clusters_pattern) <- doc_names
names(cols_pattern) <- doc_names
dist_matrix <- dist(frequency_matrix, method = measure)
hierarch_clust <- hclust(dist_matrix, method = method)
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_base.png", sep = ""),
sep = "/"
)
png(plot_file)
plot(hierarch_clust)
dev.off()
dend <- as.dendrogram(hierarch_clust)
clusters_count <- find_k(dend)$k
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_color.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
k = clusters_count,
col = cols
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_pattern.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
col = cols_pattern[dend %>% labels]
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
clusters <- cutree(hierarch_clust, k = clusters_count)
clusters_matrix = matrix(0, doc_count, clusters_count)
rownames(clusters_matrix) <- doc_names
for (doc in 1:doc_count) {
clusters_matrix[doc, clusters[doc]] <- 1
}
plot_file <- paste(
clusters_dir,
paste("matrix_",name,".png", sep = ""),
sep = "/"
)
png(plot_file)
# par(mai = c(1,1,1,4))
corrplot(clusters_matrix)
dev.off()
rand_pattern_experiment <- comPart(clusters, clusters_pattern)
#rand_experiment1_experiment2 <- comPart(clusters_1, clusters_2)
plot_file <- paste(
clusters_dir,
"FM_index.png",
sep = "/"
)
png(plot_file)
Bk_plot(
dend_1,
dend_2,
add_E = F,
rejection_line_asymptotic = F,
main = "Indeks Fawlkes'a - Mallows'a"
)
png(plot_file)
Bk_plot(
dend,
dend,
add_E = F,
rejection_line_asymptotic = F,
main = "Indeks Fawlkes'a - Mallows'a"
)
dev.off()
### Analiza skupień ###
# utworzenie katalogu na wyniki
clusters_dir <- "./clusters"
dir.create(clusters_dir)
# analiza skupień
clusters_pattern <- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)
cols_pattern <- cols[clusters_pattern]
frequency_matrix <- dtm_tfidf_all_m
measure <- "cosine"
method <- "ward.D2"
name <- "tfidf_all"
doc_names <- rownames(frequency_matrix)
doc_count <- length(doc_names)
names(clusters_pattern) <- doc_names
names(cols_pattern) <- doc_names
dist_matrix <- dist(frequency_matrix, method = measure)
hierarch_clust <- hclust(dist_matrix, method = method)
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_base.png", sep = ""),
sep = "/"
)
png(plot_file)
plot(hierarch_clust)
dev.off()
dend <- as.dendrogram(hierarch_clust)
clusters_count <- find_k(dend)$k
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_color.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
k = clusters_count,
col = cols
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_pattern.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
col = cols_pattern[dend %>% labels]
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
clusters <- cutree(hierarch_clust, k = clusters_count)
clusters_matrix = matrix(0, doc_count, clusters_count)
rownames(clusters_matrix) <- doc_names
for (doc in 1:doc_count) {
clusters_matrix[doc, clusters[doc]] <- 1
}
plot_file <- paste(
clusters_dir,
paste("matrix_",name,".png", sep = ""),
sep = "/"
)
png(plot_file)
# par(mai = c(1,1,1,4))
corrplot(clusters_matrix)
dev.off()
rand_pattern_experiment <- comPart(clusters, clusters_pattern)
#rand_experiment1_experiment2 <- comPart(clusters_1, clusters_2)
plot_file <- paste(
clusters_dir,
"FM_index.png",
sep = "/"
)
png(plot_file)
Bk_plot(
dend_1,
dend_2,
add_E = F,
rejection_line_asymptotic = F,
main = "Indeks Fawlkes'a - Mallows'a"
)
clusters_pattern <- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)
cols_pattern <- cols[clusters_pattern]
frequency_matrix <- dtm_tfidf_all_m
measure <- "cosine"
method <- "ward.D2"
name <- "tfidf_all"
doc_names <- rownames(frequency_matrix)
doc_count <- length(doc_names)
names(clusters_pattern) <- doc_names
names(cols_pattern) <- doc_names
dist_matrix <- dist(frequency_matrix, method = measure)
hierarch_clust <- hclust(dist_matrix, method = method)
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_base.png", sep = ""),
sep = "/"
)
png(plot_file)
plot(hierarch_clust)
dev.off()
dend_h <- as.dendrogram(hierarch_clust)
clusters_count <- find_k(dend_h)$k
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_color.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend_h,
k = clusters_count,
col = cols
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
plot_file <- paste(
clusters_dir,
paste("dend_",name,"_pattern.png", sep = ""),
sep = "/"
)
dend_colored <- color_branches(
dend,
col = cols_pattern[dend %>% labels]
)
png(plot_file, width = 600)
par(mai = c(1,1,1,4))
plot(dend_colored, horiz = T)
dev.off()
clusters <- cutree(hierarch_clust, k = clusters_count)
clusters_matrix = matrix(0, doc_count, clusters_count)
rownames(clusters_matrix) <- doc_names
for (doc in 1:doc_count) {
clusters_matrix[doc, clusters[doc]] <- 1
}
plot_file <- paste(
clusters_dir,
paste("matrix_",name,".png", sep = ""),
sep = "/"
)
png(plot_file)
# par(mai = c(1,1,1,4))
corrplot(clusters_matrix)
dev.off()
rand_pattern_experiment <- comPart(clusters, clusters_pattern)
#rand_experiment1_experiment2 <- comPart(clusters_1, clusters_2)
plot_file <- paste(
clusters_dir,
"FM_index.png",
sep = "/"
)
png(plot_file)
Bk_plot(
dend_h,
dend_2,
add_E = F,
rejection_line_asymptotic = F,
main = "Indeks Fawlkes'a - Mallows'a"
)
png(plot_file)
Bk_plot(
dend_h,
dend_h,
add_E = F,
rejection_line_asymptotic = F,
main = "Indeks Fawlkes'a - Mallows'a"
)
dev.off()
